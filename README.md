# Telegram Chat Analyzer

Локальный Python-скрипт для анализа личных Telegram-переписок (не бот), ориентирован на выявление проблемных чатов менеджеров с клиентами.

## Что делает

- Подключается к Telegram-аккаунту (через Telethon)
- Загружает 10 последних личных чатов (user-to-user)
- Исключает: ботов, группы, каналы, избранное
- Анализирует сообщения на наличие:
  - Обещаний, которые не были выполнены
  - Негативных фраз со стороны клиента
  - Недостаточной инициативности со стороны менеджера
- Вычисляет:
  - Среднюю скорость ответа менеджера
  - Общее количество сообщений
- Сохраняет результат в:
  - JSON-файлы (история чатов)
  - CSV-отчёт (сводная аналитика)

## Установка

1. Клонировать репозиторий:
   git clone https://github.com/PeyrenkovIvan/telegram_chat_analyzer
   cd telegram-chat-analyzer

2. Создать виртуальное окружение:
   python -m venv venv
   source venv/bin/activate     # или venv\Scripts\activate для Windows

3. Установить зависимости:
   pip install -r requirements.txt

## Настройка Telegram API

1. Перейдите на https://my.telegram.org
2. Авторизуйтесь и создайте приложение в разделе API Development Tools
3. Получите api_id и api_hash
4. Создайте файл config.json в корне проекта:

{
  "api_id": 123456,
  "api_hash": "abcdef1234567890abcdef1234567890",
  "phone": "+380XXXXXXXXX"
}

## Запуск

python main.py

После запуска:
- Произойдёт авторизация через код Telegram
- Будут загружены 10 последних личных чатов
- Все чаты сохранятся в папку data/ в формате JSON
- Будет выполнен анализ содержимого
- Сформируется файл chat_analysis_report.csv со сводной аналитикой

## Структура проекта

telegram_chat_analyzer/
├── main.py                      # Основной скрипт
├── config.json                  # Конфигурация подключения
├── tg_client.py                 # Работа с Telegram API
├── ai_module.py                 # Заглушки анализа
├── analyzer.py                  # Расчёт метрик и отчёт
├── requirements.txt             # Зависимости проекта
├── README.md                    # Инструкция
├── data/                        # JSON-файлы чатов
├── chat_analysis_report.csv     # CSV отчёт
└── session.session              # Сессионный файл Telethon

## Как работает AI (stub-анализ)

Вместо настоящего ИИ используются правила:

- Если менеджер написал что-то вроде "скину", "до вечера", "посчитаю", но не прислал follow-up — это считается нарушенным обещанием
- Если клиент пишет "плохо", "долго", "недоволен", "жах" — считается негативом
- Если от менеджера мало сообщений или нет инициативных фраз — считается низкой инициативностью

## Пример отчёта

chat_id | title       | broken_promise | negative | low_initiative | total_messages | avg_reply_time_minutes
--------|-------------|----------------|----------|----------------|----------------|-------------------------
123456  | Иван Иванов | True           | False    | True           | 14             | 23.5

## Зависимости

- telethon
- pandas

Устанавливаются через pip install -r requirements.txt